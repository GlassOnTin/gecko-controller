var ee=Object.create;var N=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var re=Object.getOwnPropertyNames;var ne=Object.getPrototypeOf,se=Object.prototype.hasOwnProperty;var C=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ae=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of re(t))!se.call(e,s)&&s!==r&&N(e,s,{get:()=>t[s],enumerable:!(n=te(t,s))||n.enumerable});return e};var y=(e,t,r)=>(r=e!=null?ee(ne(e)):{},ae(t||!e||!e.__esModule?N(r,"default",{value:e,enumerable:!0}):r,e));var q=C(a=>{"use strict";var v=Symbol.for("react.element"),oe=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),ue=Symbol.for("react.strict_mode"),le=Symbol.for("react.profiler"),ce=Symbol.for("react.provider"),de=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),ye=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),k=Symbol.iterator;function he(e){return e===null||typeof e!="object"?null:(e=k&&e[k]||e["@@iterator"],typeof e=="function"?e:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,j={};function m(e,t,r){this.props=e,this.context=t,this.refs=j,this.updater=r||P}m.prototype.isReactComponent={};m.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function M(){}M.prototype=m.prototype;function L(e,t,r){this.props=e,this.context=t,this.refs=j,this.updater=r||P}var O=L.prototype=new M;O.constructor=L;U(O,m.prototype);O.isPureReactComponent=!0;var B=Array.isArray,V=Object.prototype.hasOwnProperty,A={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function Y(e,t,r){var n,s={},o=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)V.call(t,n)&&!F.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:v,type:e,key:o,ref:i,props:s,_owner:A.current}}function ve(e,t){return{$$typeof:v,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function H(e){return typeof e=="object"&&e!==null&&e.$$typeof===v}function Ee(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var $=/\/+/g;function D(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ee(""+e.key):t.toString(36)}function w(e,t,r,n,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case v:case oe:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+D(i,0):n,B(s)?(r="",e!=null&&(r=e.replace($,"$&/")+"/"),w(s,t,r,"",function(c){return c})):s!=null&&(H(s)&&(s=ve(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace($,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",B(e))for(var l=0;l<e.length;l++){o=e[l];var u=n+D(o,l);i+=w(o,t,r,u,s)}else if(u=he(e),typeof u=="function")for(e=u.call(e),l=0;!(o=e.next()).done;)o=o.value,u=n+D(o,l++),i+=w(o,t,r,u,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function I(e,t,r){if(e==null)return e;var n=[],s=0;return w(e,n,"","",function(o){return t.call(r,o,s++)}),n}function ge(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var d={current:null},x={transition:null},_e={ReactCurrentDispatcher:d,ReactCurrentBatchConfig:x,ReactCurrentOwner:A};function G(){throw Error("act(...) is not supported in production builds of React.")}a.Children={map:I,forEach:function(e,t,r){I(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(t){return t})||[]},only:function(e){if(!H(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};a.Component=m;a.Fragment=ie;a.Profiler=le;a.PureComponent=L;a.StrictMode=ue;a.Suspense=pe;a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_e;a.act=G;a.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=U({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=A.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)V.call(t,u)&&!F.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];n.children=l}return{$$typeof:v,type:e.type,key:s,ref:o,props:n,_owner:i}};a.createContext=function(e){return e={$$typeof:de,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ce,_context:e},e.Consumer=e};a.createElement=Y;a.createFactory=function(e){var t=Y.bind(null,e);return t.type=e,t};a.createRef=function(){return{current:null}};a.forwardRef=function(e){return{$$typeof:fe,render:e}};a.isValidElement=H;a.lazy=function(e){return{$$typeof:me,_payload:{_status:-1,_result:e},_init:ge}};a.memo=function(e,t){return{$$typeof:ye,type:e,compare:t===void 0?null:t}};a.startTransition=function(e){var t=x.transition;x.transition={};try{e()}finally{x.transition=t}};a.unstable_act=G;a.useCallback=function(e,t){return d.current.useCallback(e,t)};a.useContext=function(e){return d.current.useContext(e)};a.useDebugValue=function(){};a.useDeferredValue=function(e){return d.current.useDeferredValue(e)};a.useEffect=function(e,t){return d.current.useEffect(e,t)};a.useId=function(){return d.current.useId()};a.useImperativeHandle=function(e,t,r){return d.current.useImperativeHandle(e,t,r)};a.useInsertionEffect=function(e,t){return d.current.useInsertionEffect(e,t)};a.useLayoutEffect=function(e,t){return d.current.useLayoutEffect(e,t)};a.useMemo=function(e,t){return d.current.useMemo(e,t)};a.useReducer=function(e,t,r){return d.current.useReducer(e,t,r)};a.useRef=function(e){return d.current.useRef(e)};a.useState=function(e){return d.current.useState(e)};a.useSyncExternalStore=function(e,t,r){return d.current.useSyncExternalStore(e,t,r)};a.useTransition=function(){return d.current.useTransition()};a.version="18.3.1"});var R=C((Oe,z)=>{"use strict";z.exports=q()});var K=C(b=>{"use strict";var Se=R(),Ce=Symbol.for("react.element"),Ie=Symbol.for("react.fragment"),we=Object.prototype.hasOwnProperty,xe=Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Re={key:!0,ref:!0,__self:!0,__source:!0};function W(e,t,r){var n,s={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)we.call(t,n)&&!Re.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Ce,type:e,key:o,ref:i,props:s,_owner:xe.current}}b.Fragment=Ie;b.jsx=W;b.jsxs=W});var E=C((He,J)=>{"use strict";J.exports=K()});var g=y(R()),p=y(E()),be=()=>{let[e,t]=(0,g.useState)(null),[r,n]=(0,g.useState)(null);(0,g.useEffect)(()=>{let l=async()=>{try{let c=await fetch("/api/display");if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);let h=await c.json();if(h.status==="success")t(h.image),n(null);else throw new Error(h.message||"Failed to fetch display image")}catch(c){console.error("Error fetching display:",c),n(c.message)}};l();let u=setInterval(l,1e3);return()=>clearInterval(u)},[]);let s=4,o=128*s,i=64*s;return r?(0,p.jsxs)("div",{className:"w-full max-w-md mx-auto p-4 text-red-500 text-center",children:["Error: ",r]}):(0,p.jsx)("div",{className:"w-full max-w-md mx-auto p-4",children:e?(0,p.jsx)("div",{className:"bg-black rounded-lg p-4 flex items-center justify-center",style:{width:`${o}px`,height:`${i}px`,margin:"0 auto"},children:(0,p.jsx)("img",{src:`data:image/png;base64,${e}`,alt:"OLED Display",style:{width:"100%",height:"100%",imageRendering:"pixelated"}})}):(0,p.jsx)("div",{className:"w-full h-32 flex items-center justify-center",children:(0,p.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-gray-900"})})})},Z=be;var T=y(R()),f=y(E()),Te=()=>{let[e,t]=(0,T.useState)({serviceRunning:!1,configValid:!1,backupExists:!1,lightStatus:!1,heatStatus:!1,lastUpdate:null,error:null});(0,T.useEffect)(()=>{let n=async()=>{try{let i=await(await fetch("/api/status")).json(),u=await(await fetch("/api/logs")).json(),c=u.light.length-1,h=c>=0?!!u.light[c]:!1,X=c>=0?!!u.heat[c]:!1;t({serviceRunning:i.details.service_running,configValid:i.details.config_valid,backupExists:i.details.backup_exists,lightStatus:h,heatStatus:X,lastUpdate:new Date,error:null})}catch(o){t(i=>({...i,error:o.message,lastUpdate:new Date}))}};n();let s=setInterval(n,3e4);return()=>clearInterval(s)},[]);let r={light:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <circle cx="12" cy="12" r="5"/>
    <line x1="12" y1="1" x2="12" y2="3"/>
    <line x1="12" y1="21" x2="12" y2="23"/>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
    <line x1="1" y1="12" x2="3" y2="12"/>
    <line x1="21" y1="12" x2="23" y2="12"/>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
    </svg>`,heat:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="M12 2v20M8 6l8 4-8 4 8 4"/>
    </svg>`};return(0,f.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,f.jsx)("div",{className:`control-indicator ${e.lightStatus?"active":"inactive"}`,dangerouslySetInnerHTML:{__html:r.light},title:`Light: ${e.lightStatus?"ON":"OFF"}`}),(0,f.jsx)("div",{className:`control-indicator ${e.heatStatus?"active":"inactive"}`,dangerouslySetInnerHTML:{__html:r.heat},title:`Heat: ${e.heatStatus?"ON":"OFF"}`}),(0,f.jsx)("div",{className:`status-icon ${e.serviceRunning?"running":"stopped"}`,children:(0,f.jsxs)("div",{className:"status-details-card",children:[(0,f.jsxs)("div",{className:"status-header",children:["Service: ",e.serviceRunning?"Running":"Stopped"]}),(0,f.jsxs)("div",{className:"status-details",children:[(0,f.jsxs)("div",{children:["Configuration: ",e.configValid?"Valid":"Invalid"]}),(0,f.jsxs)("div",{children:["Backup Available: ",e.backupExists?"Yes":"No"]})]}),e.lastUpdate&&(0,f.jsxs)("div",{className:"status-timestamp",children:["Last Updated: ",e.lastUpdate.toLocaleTimeString()]}),e.error&&(0,f.jsxs)("div",{className:"status-error",children:["Error: ",e.error]})]})})]})},Q=Te;var _=class{static async loadConfig(){try{let r=await(await fetch("/api/config")).json();this.updateFormFields(r)}catch(t){console.error("Error loading config:",t),this.showStatus("Error loading configuration: "+t.message,"error")}}static updateFormFields(t){document.getElementById("MIN_TEMP").value=t.MIN_TEMP,document.getElementById("DAY_TEMP").value=t.DAY_TEMP,document.getElementById("TEMP_TOLERANCE").value=t.TEMP_TOLERANCE,document.getElementById("LIGHT_ON_TIME").value=t.LIGHT_ON_TIME,document.getElementById("LIGHT_OFF_TIME").value=t.LIGHT_OFF_TIME,document.getElementById("UVA_THRESHOLDS_low").value=t.UVA_THRESHOLDS.low,document.getElementById("UVA_THRESHOLDS_high").value=t.UVA_THRESHOLDS.high,document.getElementById("UVB_THRESHOLDS_low").value=t.UVB_THRESHOLDS.low,document.getElementById("UVB_THRESHOLDS_high").value=t.UVB_THRESHOLDS.high,document.getElementById("SENSOR_HEIGHT").value=t.SENSOR_HEIGHT,document.getElementById("LAMP_DIST_FROM_BACK").value=t.LAMP_DIST_FROM_BACK,document.getElementById("ENCLOSURE_HEIGHT").value=t.ENCLOSURE_HEIGHT,document.getElementById("SENSOR_ANGLE").value=t.SENSOR_ANGLE;let r=document.getElementById("DISPLAY_ADDRESS");r.value=this.formatI2CAddress(t.DISPLAY_ADDRESS),document.getElementById("DISPLAY_RESET").value=t.DISPLAY_RESET,document.getElementById("LIGHT_RELAY").value=t.LIGHT_RELAY,document.getElementById("HEAT_RELAY").value=t.HEAT_RELAY}static formatI2CAddress(t){let r=String(t).replace(/^0x/i,"").replace(/\s/g,"");return r=r.replace(/[^0-9A-Fa-f]/g,"").slice(0,2),r?`0x${r.toLowerCase()}`:""}static showStatus(t,r){let n=document.getElementById("status");n.textContent=t,n.className=`status ${r}`,n.style.display="block",setTimeout(()=>n.style.display="none",3e3)}static async saveConfig(t){let r={};for(let[n,s]of t.entries())if(n.includes(".")){let[o,i]=n.split(".");r[o]||(r[o]={}),r[o][i]=parseFloat(s)}else n==="DISPLAY_ADDRESS"?r[n]=parseInt(s,16):document.getElementById(n).type==="number"?r[n]=parseFloat(s):r[n]=s;try{let s=await(await fetch("/api/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();this.showStatus(s.status==="success"?"Settings saved successfully!":"Error saving settings: "+s.message,s.status==="success"?"success":"error")}catch(n){console.error("Error:",n),this.showStatus("Error saving settings: "+n.message,"error")}}},S=class{static tempHumidityChart=null;static uvChart=null;static initializeCharts(){if(typeof Chart>"u"){console.error("Chart.js not loaded");return}Chart.register(Chart.LineController,Chart.LineElement,Chart.PointElement,Chart.LinearScale,Chart.CategoryScale,Chart.Legend,Chart.Tooltip),this.initializeTempHumidityChart(),this.initializeUVChart()}static initializeTempHumidityChart(){let t=document.getElementById("tempHumidityChart");t&&(this.tempHumidityChart=new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"Temperature (\xB0C)",borderColor:"rgb(255, 99, 132)",yAxisID:"y",tension:.1,data:[]},{label:"Humidity (%)",borderColor:"rgb(54, 162, 235)",yAxisID:"y1",tension:.1,data:[]}]},options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:{x:{type:"category",display:!0},y:{type:"linear",display:!0,position:"left"},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1}}}}}))}static initializeUVChart(){let t=document.getElementById("uvChart");t&&(this.uvChart=new Chart(t,{type:"line",data:{labels:[],datasets:[{label:"UVA (\u03BCW/cm\xB2)",borderColor:"rgb(255, 159, 64)",yAxisID:"y",tension:.1,data:[]},{label:"UVB (\u03BCW/cm\xB2)",borderColor:"rgb(75, 192, 192)",yAxisID:"y1",tension:.1,data:[]},{label:"UVC (\u03BCW/cm\xB2)",borderColor:"rgb(153, 102, 255)",yAxisID:"y1",tension:.1,data:[]}]},options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:{x:{type:"category",display:!0},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"UVA (\u03BCW/cm\xB2)"},beginAtZero:!0,min:0,suggestedMax:200},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"UVB/UVC (\u03BCW/cm\xB2)"},beginAtZero:!0,min:0,suggestedMax:10,grid:{drawOnChartArea:!1}}}}}))}static async updateCharts(){try{let t=await fetch("/api/logs");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let r=await t.json();this.tempHumidityChart&&(this.tempHumidityChart.data.labels=r.timestamps,this.tempHumidityChart.data.datasets[0].data=r.temperature,this.tempHumidityChart.data.datasets[1].data=r.humidity,this.tempHumidityChart.update()),this.uvChart&&(this.uvChart.data.labels=r.timestamps,this.uvChart.data.datasets[0].data=r.uva,this.uvChart.data.datasets[1].data=r.uvb,this.uvChart.data.datasets[2].data=r.uvc,this.uvChart.update())}catch(t){console.error("Error updating charts:",t)}}};document.addEventListener("DOMContentLoaded",function(){S.initializeCharts(),S.updateCharts(),setInterval(()=>S.updateCharts(),6e4),_.loadConfig();let e=document.getElementById("liveDisplay");e&&ReactDOM.render(React.createElement(Z),e);let t=document.getElementById("statusContainer");t&&ReactDOM.render(React.createElement(Q),t);let r=document.getElementById("configForm");r&&r.addEventListener("submit",async s=>{s.preventDefault(),await _.saveConfig(new FormData(s.target))});let n=document.getElementById("DISPLAY_ADDRESS");n&&n.addEventListener("change",()=>{n.value=_.formatI2CAddress(n.value)})});fetch=function(e){return function(...t){return typeof t[0]=="string"&&t[0].startsWith("/api/")&&(t[1]||(t[1]={}),t[1].headers||(t[1].headers={}),t[1].headers["Cache-Control"]="no-store, no-cache, must-revalidate",t[1].headers.Pragma="no-cache"),e.apply(this,t)}}(fetch);
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
